on: [push]

jobs:
  test_job:
    runs-on: ubuntu-latest
    name: Test Job
    steps:
      # To use this repository's private action,
      # you must check out the repository
      - name: Checkout
        uses: actions/checkout@v3
      - name: Mount bazel cache
        uses: actions/cache@v1
        with:
          path: "/home/runner/.cache/bazel"
          key: bazel
      - name: Mount pulumi plugin cache
        uses: actions/cache@v1
        with:
          path: "/home/runner/.pulumi/plugins"
          key: pulumi
      - name: Install bazelisk
          run: |
            curl "https://github.com/bazelbuild/bazelisk/releases/download/v1.12.0/bazelisk-linux-amd64" > /usr/bin/bazel
            echo "6b0bcb2ea15bca16fffabe6fda75803440375354c085480fe361d2cbf32501db /usr/bin/bazel" | sha256sum -c 
            chmod +x /usr/bin/bazel
      - name: Test
          run: |
            test/test.sh
